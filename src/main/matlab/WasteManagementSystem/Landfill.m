%% Landfill Class Definition
% The ThermalTreatment behavior calculates the useable energy extracted
% from incineration, RDF burning, and PPDF burning. In addition, the amount
% of recovered ferrous metal is also calculated.
% The inputs to this object arise from the WasteSorting.m, MRFSorting.m,
% RDFSorting.m, and BiologicalTreatment.m objects.
% In addition, the amount of non-hazardous and hazardous residues is
% calculated. This residue is in turn sent to landfill
%
% 7-September, 2011
% Sydney Do, sydneydo@mit.edu
%%
classdef Landfill < Behavior
    properties
        restwaste_to_landfill;                      % the additional restwaste added from the sorting process (function input)
        mrf_residues_to_landfill;                   % residues generated by the materials recovery facility sent to landfill (function input)
        rdf_screened_materials_to_landfill;         % materials pre-screened during the RDF sorting process sent to landfill (function input)
        rdf_fines_to_landfill;                      % fines generated during the RDF sorting process sent to landfill (function input)
        rdf_residues_to_landfill;                   % residues generated during the RDF sorting process sent to landfill (function input)
        bio_residues_to_landfill;                   % residues generated during the biological treatment process sent to landfill (function input)
        thermal_non_hazardous_residues_to_landfill; % non-hazardous residues generated during the thermal treatment process sent to landfill (function input)
        thermal_hazardous_residues_to_landfill;     % hazardous residues generated during the thermal treatment process sent to landfill (function input)
        total_non_hazardous_input;                  % the non-hazardous total waste stream input to landfill
        total_hazardous_input;                      % the hazardous total waste stream input to landfill
        landfill_gas_generated;                     % the total amount of landfill gas generated from the landfill input (in m^3)
        non_hazardous_leachate_generated;           % the total amount of leachate generated from the non-hazardous landfill (in m^3)
        hazardous_leachate_generated;               % the total amount of leachate generated from the hazardous landfill (in m^3)
    end
    methods
        %% Landfill Constructor
        % Instantiates a new Landfill object.
        % 
        % obj = Landfill()
        %   obj:                                        the new Landfill object
        %   restwaste_to_landfill:                      the additional restwaste added from the sorting process (function input)
        %   mrf_residues_to_landfill:                   residues generated by the materials recovery facility sent to landfill (function input)
        %   rdf_screened_materials_to_landfill:         materials pre-screened during the RDF sorting process sent to landfill (function input)
        %   rdf_fines_to_landfill:                      fines generated during the RDF sorting process sent to landfill (function input)
        %   rdf_residues_to_landfill:                   residues generated during the RDF sorting process sent to landfill (function input)
        %   bio_residues_to_landfill:                   residues generated during the biological treatment process sent to landfill (function input)
        %   thermal_non_hazardous_residues_to_landfill: non-hazardous residues generated during the thermal treatment process sent to landfill (function input)
        %   thermal_hazardous_residues_to_landfil:      hazardous residues generated during the thermal treatment process sent to landfill (function input)
        %   total_non_hazardous_input:                  the non-hazardous total waste stream input to landfill
        %   total_hazardous_input:                      the hazardous total waste stream input to landfill
        %   landfill_gas_generated:                     the total amount of landfill gas generated from the landfill input (in m^3)
        %   non_hazardous_leachate_generated:           the total amount of leachate generated from the non-hazardous landfill (in m^3)
        %   hazardous_leachate_generated:               the total amount of leachate generated from the hazardous landfill (in m^3)
        
        function obj = Landfill()
            obj = obj@Behavior('Landfill', ...
                'Calculates the leachate and gas generated by the landfill process', ...
                'm^3','[0,inf)');
        end
    end
    methods(Access=protected)
        %% EvaluateImpl Function
        % Evaluates the behavior for a specified city. Note: the
        % superclass Evaluate function should be used for evaluation during
        % execution.
        %
        % val = obj.EvaluateImpl(city)
        %   val:    the evaluated value
        %   obj:    the TotalResidentialWaste object handle
        function val = EvaluateImpl(obj)      
            
            %% Determine total non-hazardous input to landfill
            
            % Paper Stream
            obj.total_non_hazardous_input.paper = obj.restwaste_to_landfill.paper+...
                obj.mrf_residues_to_landfill.paper+...
                obj.rdf_screened_materials_to_landfill.paper+...
                obj.rdf_fines_to_landfill.paper+...
                obj.rdf_residues_to_landfill.paper+...
                obj.bio_residues_to_landfill.paper+...
                obj.thermal_non_hazardous_residues_to_landfill.paper;
            
            % Glass Stream
            obj.total_non_hazardous_input.glass = obj.restwaste_to_landfill.glass+...
                obj.mrf_residues_to_landfill.glass+...
                obj.rdf_screened_materials_to_landfill.glass+...
                obj.rdf_fines_to_landfill.glass+...
                obj.rdf_residues_to_landfill.glass+...
                obj.bio_residues_to_landfill.glass+...
                obj.thermal_non_hazardous_residues_to_landfill.glass;
            
            % Ferrous Metal Stream
            obj.total_non_hazardous_input.fe_metal = obj.restwaste_to_landfill.fe_metal+...
                obj.mrf_residues_to_landfill.fe_metal+...
                obj.rdf_screened_materials_to_landfill.fe_metal+...
                obj.rdf_fines_to_landfill.fe_metal+...
                obj.rdf_residues_to_landfill.fe_metal+...
                obj.thermal_non_hazardous_residues_to_landfill.fe_metal;
            
            % Non-Ferrous Metal Stream
            obj.total_non_hazardous_input.nonfe_metal = obj.restwaste_to_landfill.nonfe_metal+...
                obj.mrf_residues_to_landfill.nonfe_metal+...
                obj.rdf_screened_materials_to_landfill.nonfe_metal+...
                obj.rdf_fines_to_landfill.nonfe_metal+...
                obj.rdf_residues_to_landfill.nonfe_metal+...
                obj.bio_residues_to_landfill.nonfe_metal+...
                obj.thermal_non_hazardous_residues_to_landfill.nonfe_metal;

            % Film Plastic Stream
            obj.total_non_hazardous_input.filmplastic = obj.restwaste_to_landfill.filmplastic+...
                obj.mrf_residues_to_landfill.filmplastic+...
                obj.rdf_screened_materials_to_landfill.filmplastic+...
                obj.rdf_fines_to_landfill.filmplastic+...
                obj.rdf_residues_to_landfill.filmplastic+...
                obj.bio_residues_to_landfill.filmplastic+...
                obj.thermal_non_hazardous_residues_to_landfill.filmplastic;
            
            % Rigid Plastic Stream
            obj.total_non_hazardous_input.rigidplastic = obj.restwaste_to_landfill.rigidplastic+...
                obj.mrf_residues_to_landfill.rigidplastic+...
                obj.rdf_screened_materials_to_landfill.rigidplastic+...
                obj.rdf_fines_to_landfill.rigidplastic+...
                obj.rdf_residues_to_landfill.rigidplastic+...
                obj.bio_residues_to_landfill.rigidplastic+...
                obj.thermal_non_hazardous_residues_to_landfill.rigidplastic;
            
            % Textiles Stream
            obj.total_non_hazardous_input.textiles = obj.restwaste_to_landfill.textiles+...
                obj.mrf_residues_to_landfill.textiles+...
                obj.rdf_screened_materials_to_landfill.textiles+...
                obj.rdf_fines_to_landfill.textiles+...
                obj.rdf_residues_to_landfill.textiles+...
                obj.bio_residues_to_landfill.textiles+...
                obj.thermal_non_hazardous_residues_to_landfill.textiles;
            
            % Organics Stream
            obj.total_non_hazardous_input.organics = obj.restwaste_to_landfill.organics+...
                obj.mrf_residues_to_landfill.organics+...
                obj.rdf_screened_materials_to_landfill.organics+...
                obj.rdf_fines_to_landfill.organics+...
                obj.rdf_residues_to_landfill.organics+...
                obj.bio_residues_to_landfill.organics+...
                obj.thermal_non_hazardous_residues_to_landfill.organics;
            
            % Other Stream
            obj.total_non_hazardous_input.other = obj.restwaste_to_landfill.other+...
                obj.mrf_residues_to_landfill.other+...
                obj.rdf_screened_materials_to_landfill.other+...
                obj.rdf_fines_to_landfill.other+...
                obj.rdf_residues_to_landfill.other+...
                obj.bio_residues_to_landfill.other+...
                obj.thermal_non_hazardous_residues_to_landfill.other;
            
            % Compost Stream
            obj.total_non_hazardous_input.compost = obj.thermal_non_hazardous_residues_to_landfill.compost;
            
            % Bottom Ash Stream
            obj.total_non_hazardous_input.bottom_ash = obj.thermal_non_hazardous_residues_to_landfill.fuels;
            
            %% Determine total hazardous input to landfill
            obj.total_hazardous_input = obj.thermal_hazardous_residues_to_landfill;
            
            %% Determine amount of landfill gas generated (m^3)
            % Define landfill variables
            Landfill = LandfillVariables;
            
            obj.landfill_gas_generated = obj.total_non_hazardous_input.paper*Landfill.landfill_gas.paper+...
                obj.total_non_hazardous_input.glass*Landfill.landfill_gas.glass+...
                (obj.total_non_hazardous_input.fe_metal+obj.total_non_hazardous_input.nonfe_metal)*...
                Landfill.landfill_gas.metal+...
                (obj.total_non_hazardous_input.filmplastic+obj.total_non_hazardous_input.rigidplastic)*...
                Landfill.landfill_gas.plastic+...
                obj.total_non_hazardous_input.textiles*Landfill.landfill_gas.textiles+...
                obj.total_non_hazardous_input.organics*Landfill.landfill_gas.organics+...
                obj.total_non_hazardous_input.other*Landfill.landfill_gas.other+...
                obj.total_non_hazardous_input.compost*Landfill.landfill_gas.compost+...
                obj.total_non_hazardous_input.bottom_ash*Landfill.landfill_gas.bottom_ash;
            
            %% Determine amount of non-hazardous leachate generated from landfill (m^3)
            obj.non_hazardous_leachate_generated = obj.total_non_hazardous_input.paper*Landfill.leachate_generation.paper+...
                obj.total_non_hazardous_input.glass*Landfill.leachate_generation.glass+...
                (obj.total_non_hazardous_input.fe_metal+obj.total_non_hazardous_input.nonfe_metal)*...
                Landfill.leachate_generation.metal+...
                (obj.total_non_hazardous_input.filmplastic+obj.total_non_hazardous_input.rigidplastic)*...
                Landfill.leachate_generation.plastic+...
                obj.total_non_hazardous_input.textiles*Landfill.leachate_generation.textiles+...
                obj.total_non_hazardous_input.organics*Landfill.leachate_generation.organics+...
                obj.total_non_hazardous_input.other*Landfill.leachate_generation.other+...
                obj.total_non_hazardous_input.compost*Landfill.leachate_generation.compost+...
                obj.total_non_hazardous_input.bottom_ash*Landfill.leachate_generation.bottom_ash;
            
            %% Determine amount of non-hazardous leachate generated from landfill (m^3)
            obj.hazardous_leachate_generated = sum([obj.total_hazardous_input.paper,...
                obj.total_hazardous_input.glass,...
                obj.total_hazardous_input.fe_metal,...
                obj.total_hazardous_input.nonfe_metal,...
                obj.total_hazardous_input.filmplastic,...
                obj.total_hazardous_input.rigidplastic,...
                obj.total_hazardous_input.textiles,...
                obj.total_hazardous_input.organics,...
                obj.total_hazardous_input.other,...
                obj.total_hazardous_input.compost,...
                obj.total_hazardous_input.fuels])*Landfill.leachate_generation.hazardous;
            
            %% Assign null value to val
            val = [];
            
        end
    end
end